<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size:24px;">What is PGXS?</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">PGXS stands for &quot;PostgreSQL Extension Building Infrastructure&quot;. It is a set of Makefiles and scripts that simplify the process of building and installing PostgreSQL extensions.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">PGXS is designed to work with the <strong><span style="font-size:14px;font-family: Monaco;border: 1pt solid rgb(217, 217, 227);padding: 0cm;">pg_config</span></strong> command, which is used to determine the configuration options and file locations for your PostgreSQL installation. By using PGXS, you can avoid the need to manually specify these options in your Makefile.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size:24px;">Do I Need PGXS?</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">If you&apos;re building a simple PostgreSQL extension that consists of just one or a few source files, you may be able to build it without using PGXS. However, for more complex extensions that include multiple files and dependencies, PGXS can make the process much easier.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">In general, if you&apos;re building a PostgreSQL extension in C, you should consider using PGXS.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size:24px;">How Does PGXS Work?</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">To use PGXS, you&apos;ll need to create a Makefile for your extension that includes the appropriate PGXS rules. Here&apos;s an example Makefile:</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><br></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size: 20px;">Code:&nbsp;</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>MODULES = myext</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>PG_CONFIG = pg_config</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>PGXS := $(shell $(PG_CONFIG) --pgxs)</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>include $(PGXS)</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">&nbsp;</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">This Makefile defines a variable <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">MODULES</span></strong></code> that lists the source file(s) for your extension (in this case, just <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">myext.c</span></strong></code>), and uses the <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">pg_config</span></strong></code> command to determine the location of the PostgreSQL installation and include the appropriate build rules.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">The <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">include $(PGXS)</span></strong></code> line is what actually includes the PGXS rules. This will define a number of Makefile variables and targets that you can use to build and install your extension.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">Once you&apos;ve created your Makefile, you can use the following commands to build and install your extension:</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">&nbsp;</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size: 20px;">Code:&nbsp;</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>$ make</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>$ sudo make install</em></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">&nbsp;</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">&nbsp;</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">The <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">make</span></strong></code> command will build your extension and create a shared library file (e.g. <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">myext.so</span></strong></code>). The <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">sudo make install</span></strong></code> command will install the shared library file in the appropriate location (e.g. <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">/usr/lib/postgresql/&lt;version&gt;/lib/myext.so</span></strong></code>) and register your extension with PostgreSQL.</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;">Once your extension is installed, you can use the <code style='font-family: "Courier New";'><strong><span style="font-size: 14px; font-family: Monaco; color: rgb(0, 0, 0); border: 1pt solid rgb(217, 217, 227); padding: 0cm;">CREATE EXTENSION</span></strong></code> command to load it into a database:</p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><br></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><strong><span style="font-size: 20px;">Code:&nbsp;</span></strong></p>
<p style="margin: 0cm;font-size: medium;font-family: Calibri, sans-serif;color: rgb(0, 0, 0);font-style: normal;font-weight: 400;text-align: start;text-indent: 0px;text-decoration: none;"><em>CREATE EXTENSION myext;</em></p>
